# ğŸ“Š Email Notification System - Visual Architecture

## System Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EMEXA APPLICATION                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                 FRONTEND (React)                       â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚  Settings Page â†’ Email Notifications Toggle           â”‚    â”‚
â”‚  â”‚  User clicks: ON (ğŸŸ¢) / OFF (âš«)                      â”‚    â”‚
â”‚  â”‚  â†“                                                     â”‚    â”‚
â”‚  â”‚  API Call: PUT /api/user/notification-settings        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                            â†“                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                BACKEND (Node.js/Express)              â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚  userController.updateNotificationSettings() â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â†’ Save to: user.notificationSettings      â”‚    â”‚    â”‚
â”‚  â”‚  â”‚      .emailNotifications = true/false        â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚           â†“                                          â”‚    â”‚
â”‚  â”‚           â†“ STORED IN DATABASE                      â”‚    â”‚
â”‚  â”‚           â†“                                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚         MONGODB DATABASE                     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚                                              â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  Users Collection:                           â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  {                                           â”‚    â”‚    â”‚
â”‚  â”‚  â”‚    _id: "user123",                           â”‚    â”‚    â”‚
â”‚  â”‚  â”‚    email: "student@example.com",             â”‚    â”‚    â”‚
â”‚  â”‚  â”‚    name: "John Student",                     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚    notificationSettings: {                   â”‚    â”‚    â”‚
â”‚  â”‚  â”‚      emailNotifications: true,  â† KEY FLAG  â”‚    â”‚    â”‚
â”‚  â”‚  â”‚      inAppNotifications: true                â”‚    â”‚    â”‚
â”‚  â”‚  â”‚    }                                         â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  }                                           â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚    EVENT TRIGGERS (Quiz, Profile, etc.)     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚    â†“                                         â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Check User Preference             â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Read: emailNotifications flag     â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â†“                                 â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  if (emailNotifications === true)  â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  {                                 â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚    â†“                               â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚    SEND EMAIL âœ‰ï¸                  â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚    â†“                               â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  } else {                          â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚    SKIP EMAIL âŒ                  â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  }                                 â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â†“ ALWAYS                          â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  CREATE IN-APP NOTIFICATION ğŸ“Œ   â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚     EMAIL NOTIFICATION SERVICE               â”‚    â”‚    â”‚
â”‚  â”‚  â”‚     src/services/notificationEmail.service.jsâ”‚   â”‚    â”‚
â”‚  â”‚  â”‚                                              â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  sendEmailNotification()                     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ Fetch user from DB                      â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ Check: emailNotifications flag           â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ If false: return false (skip email)     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ If true: Create nodemailer transporter â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ Send email via Gmail SMTP              â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€ Log result                              â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚                      â†“                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚        EXTERNAL EMAIL SERVICE (Gmail)        â”‚    â”‚    â”‚
â”‚  â”‚  â”‚                                              â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  Nodemailer + Gmail SMTP                     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ HOST: smtp.gmail.com                     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ AUTH: EMAIL_USER + EMAIL_PASSWORD       â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ FROM: system@emexa.com                   â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ TO: user@example.com                     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€ SEND EMAIL                              â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                            â†“                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚            USER EMAIL INBOX                           â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚  From: EMEXA System <noreply@emexa.com>              â”‚    â”‚
â”‚  â”‚  To: student@example.com                             â”‚    â”‚
â”‚  â”‚  Subject: ğŸ“‹ New Quiz Assigned: Matrix Operations    â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚  Hi John Student,                                     â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚  A new quiz has been assigned to you...              â”‚    â”‚
â”‚  â”‚  [Professional HTML Email]                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow - All 4 Email Types

### Flow 1: Quiz Assignment Email

```
Teacher Schedule Quiz
        â†“
quizcontroller.scheduleQuiz()
        â†“
createQuizNotification()
        â†“
Fetch all Students (with email + settings)
        â†“
For each student:
  â”œâ”€ Check: emailNotifications
  â”‚  â”œâ”€ TRUE â†’ sendQuizAssignmentEmail()
  â”‚  â”‚         + sendEmailNotification()
  â”‚  â”‚         â†’ Email sent âœ‰ï¸
  â”‚  â””â”€ FALSE â†’ Skip email
  â””â”€ Always â†’ Notification.create() ğŸ“Œ
```

### Flow 2: Quiz Submission Email

```
Student Submit Quiz
        â†“
quizcontroller.submitQuizAnswers()
        â†“
Calculate Score
        â†“
Create In-App Notification
        â†“
Try send email:
  â”œâ”€ Fetch Student
  â”œâ”€ Generate HTML with score
  â”œâ”€ sendEmailNotification()
  â”‚  â”œâ”€ Check: emailNotifications
  â”‚  â”œâ”€ TRUE â†’ Send email âœ‰ï¸
  â”‚  â””â”€ FALSE â†’ Skip
  â””â”€ Catch errors gracefully
```

### Flow 3: Profile Update Email

```
User Update Profile
        â†“
userController.updateProfile()
        â†“
Save changes to DB
        â†“
Try send email:
  â”œâ”€ Generate HTML
  â”œâ”€ sendEmailNotification()
  â”‚  â”œâ”€ Check: emailNotifications
  â”‚  â”œâ”€ TRUE â†’ Send email âœ‰ï¸
  â”‚  â””â”€ FALSE â†’ Skip
  â””â”€ Catch errors gracefully
```

### Flow 4: Settings Change Email

```
User Change Settings
        â†“
userController.updateNotificationSettings()
        â†“
Compare old vs new settings
        â†“
Track what changed
        â†“
Try send email (if something changed):
  â”œâ”€ Check: emailNotifications is still ON
  â”œâ”€ TRUE â†’ Send email with changed list âœ‰ï¸
  â”œâ”€ FALSE â†’ Skip (user disabled it)
  â””â”€ Catch errors gracefully
```

---

## Decision Tree - Should Email Be Sent?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Event Triggered                     â”‚
â”‚ (Quiz, Profile, Settings, etc.)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Fetch User from Database            â”‚
â”‚ (User, Student, or Teacher)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check notificationSettings OR        â”‚
â”‚ Check settings.emailNotifications   â”‚
â”‚ (depends on user type)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    Is TRUE?     â”‚
       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
            â”‚        â”‚
          YES       NO
            â”‚        â”‚
            â†“        â†“
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ SEND    â”‚  â”‚ SKIP     â”‚
      â”‚ EMAIL   â”‚  â”‚ EMAIL    â”‚
      â”‚ âœ‰ï¸      â”‚  â”‚ âŒ       â”‚
      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
           â”‚            â”‚
           â†“            â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ALWAYS CREATE IN-APP NOTIF   â”‚
    â”‚ ğŸ“Œ (regardless of email)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Return success to user       â”‚
    â”‚ (email sent or not, they're  â”‚
    â”‚ notified in-app)             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Database Schema - Preference Storage

```
MongoDB Collections
â”‚
â”œâ”€ users
â”‚  â””â”€ {
â”‚       _id: ObjectId,
â”‚       email: "admin@example.com",
â”‚       notificationSettings: {
â”‚         emailNotifications: true,    â† Checked before emailing
â”‚         smsNotifications: false,
â”‚         inAppNotifications: true
â”‚       }
â”‚     }
â”‚
â”œâ”€ students
â”‚  â””â”€ {
â”‚       _id: ObjectId,
â”‚       email: "student@example.com",
â”‚       notificationSettings: {        â† Same structure
â”‚         emailNotifications: true,
â”‚         smsNotifications: false,
â”‚         inAppNotifications: true
â”‚       }
â”‚     }
â”‚
â””â”€ teachers
   â””â”€ {
        _id: ObjectId,
        email: "teacher@example.com",
        settings: {                     â† Different field name!
          emailNotifications: true,     â† Checked before emailing
          smsNotifications: false,
          inAppNotifications: true,
          emotionConsent: true
        }
      }
```

---

## Email Template Structure

```
All Email Templates Follow This Pattern:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         EMAIL MESSAGE                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ TO: user@example.com                    â”‚
â”‚ FROM: EMEXA System                      â”‚
â”‚ SUBJECT: [Emoji] [Action]: [Title]      â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  HEADER (Color-coded)               â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚ â”‚  â”‚ ğŸ“‹ Header Icon + Text           â”‚â”‚ â”‚
â”‚ â”‚  â”‚ (Blue for quiz, Green for ok,   â”‚â”‚ â”‚
â”‚ â”‚  â”‚  Orange for profile, Purple for  â”‚â”‚ â”‚
â”‚ â”‚  â”‚  settings)                      â”‚â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  CONTENT                            â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚ â”‚  â”‚ Hi [User Name],                 â”‚â”‚ â”‚
â”‚ â”‚  â”‚                                 â”‚â”‚ â”‚
â”‚ â”‚  â”‚ [Main message about event]      â”‚â”‚ â”‚
â”‚ â”‚  â”‚                                 â”‚â”‚ â”‚
â”‚ â”‚  â”‚ [Important details in box]      â”‚â”‚ â”‚
â”‚ â”‚  â”‚                                 â”‚â”‚ â”‚
â”‚ â”‚  â”‚ [Call to action or info]        â”‚â”‚ â”‚
â”‚ â”‚  â”‚                                 â”‚â”‚ â”‚
â”‚ â”‚  â”‚ [Security warning if needed]    â”‚â”‚ â”‚
â”‚ â”‚  â”‚                                 â”‚â”‚ â”‚
â”‚ â”‚  â”‚ Best regards,                   â”‚â”‚ â”‚
â”‚ â”‚  â”‚ EMEXA Team                      â”‚â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  FOOTER                             â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚ â”‚  â”‚ Automated message - Don't reply â”‚â”‚ â”‚
â”‚ â”‚  â”‚ Â© 2026 EMEXA. All rights        â”‚â”‚ â”‚
â”‚ â”‚  â”‚ reserved.                       â”‚â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Event Trigger Points

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          WHERE EMAILS ARE TRIGGERED                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚  ğŸ“‹ QUIZ ASSIGNMENT                                    â”‚
â”‚  â”œâ”€ File: notificationController.js                   â”‚
â”‚  â”œâ”€ Function: createQuizNotification()                â”‚
â”‚  â””â”€ Trigger: Teacher schedules/assigns quiz           â”‚
â”‚                                                        â”‚
â”‚  âœ… QUIZ SUBMISSION                                    â”‚
â”‚  â”œâ”€ File: quizcontroller.js                           â”‚
â”‚  â”œâ”€ Alt: teacherQuizController.js                     â”‚
â”‚  â”œâ”€ Function: submitQuizAnswers()                     â”‚
â”‚  â””â”€ Trigger: Student submits quiz                     â”‚
â”‚                                                        â”‚
â”‚  âœï¸ PROFILE UPDATE                                     â”‚
â”‚  â”œâ”€ File: userController.js                           â”‚
â”‚  â”œâ”€ Alt: teacherController.js                         â”‚
â”‚  â”œâ”€ Function: updateProfile()                         â”‚
â”‚  â””â”€ Trigger: User/Teacher updates name or email       â”‚
â”‚                                                        â”‚
â”‚  âš™ï¸ SETTINGS CHANGE                                    â”‚
â”‚  â”œâ”€ File: userController.js                           â”‚
â”‚  â”œâ”€ Alt: teacherController.js                         â”‚
â”‚  â”œâ”€ Function: updateNotificationSettings() / Settings()
â”‚  â””â”€ Trigger: User changes any notification settings   â”‚
â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Error Handling Flow

```
Try to Send Email
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             â”‚
SUCCESS                    ERROR
â”‚                             â”‚
â†“                             â†“
Email Sent âœ‰ï¸        Log Error Message
                              â”‚
                              â†“
                    Continue Processing
                              â”‚
                              â†“
                    In-app Notification
                    Still Created ğŸ“Œ
                              â”‚
                              â†“
                    Response Sent to User
                    (unaware of email failure)
                              â”‚
                              â†“
                    âœ… GRACEFUL FAILURE
                    (user has in-app notif)
```

---

## Testing Scenarios Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Email Setting   â”‚ Event Triggered      â”‚ Expected Result     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ON (ğŸŸ¢)         â”‚ Quiz Assigned        â”‚ Email Sent âœ‰ï¸       â”‚
â”‚                 â”‚                      â”‚ In-app Notif ğŸ“Œ     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OFF (âš«)         â”‚ Quiz Assigned        â”‚ No Email âŒ         â”‚
â”‚                 â”‚                      â”‚ In-app Notif ğŸ“Œ     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ON (ğŸŸ¢)         â”‚ Quiz Submitted       â”‚ Email with Score âœ‰ï¸ â”‚
â”‚                 â”‚                      â”‚ In-app Notif ğŸ“Œ     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OFF (âš«)         â”‚ Quiz Submitted       â”‚ No Email âŒ         â”‚
â”‚                 â”‚                      â”‚ In-app Notif ğŸ“Œ     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ON (ğŸŸ¢)         â”‚ Profile Updated      â”‚ Email Sent âœ‰ï¸       â”‚
â”‚                 â”‚                      â”‚ In-app Notif ğŸ“Œ     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OFF (âš«)         â”‚ Profile Updated      â”‚ No Email âŒ         â”‚
â”‚                 â”‚                      â”‚ In-app Notif ğŸ“Œ     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ON (ğŸŸ¢)         â”‚ Settings Changed     â”‚ Email Sent âœ‰ï¸       â”‚
â”‚                 â”‚                      â”‚ In-app Notif ğŸ“Œ     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OFF (âš«)         â”‚ Settings Changed     â”‚ No Email âŒ         â”‚
â”‚                 â”‚                      â”‚ In-app Notif ğŸ“Œ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Visual Documentation Complete** âœ…
